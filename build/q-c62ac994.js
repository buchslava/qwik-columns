import{z as _,k as L,a as n,_ as a,C as A,S as E,l as T,n as w,r as C,X as V,N as g,O as p,U as O,o as c,b as k}from"./q-1f2f0220.js";import{P as t,m as D,s as b,i as f,a as P,e as N,b as y,c as x,d as z,f as G,g as M,h as $,r as U,j as I,k as F,l as Y,S as Q,L as Z,n as H,o as R,p as K}from"./q-d74610db.js";import{C as B}from"./q-45a7ec37.js";const J=()=>{const[e]=_();e.game.phase===t.MOVING&&(e.game.phase=t.DROP)},W=()=>{const[e,s]=_();s.game.phase===t.MOVING&&(D(s.game),e())},X=()=>{const[e,s]=_();s.game.phase===t.MOVING&&(b(s.game),e())},j=()=>{const[e,s]=_(),o=s.game;if(o.phase!==t.FLYING){if(o.phase===t.MOVING)f(o)?P(o):(N(o),y(o,s.level)?(o.phase=t.INACTIVE,s.gameOverPopup=!0):o.phase=t.MATCH_REQUEST);else if(o.phase===t.DROP){const r=x(o);let h=0;for(;f(r);)P(r),h++;e(h);return}else o.phase===t.MATCH_REQUEST?z(o,s.level,!0)?o.phase=t.COLLAPSE_REQUEST:(G(o),o.phase=t.MOVING):o.phase===t.COLLAPSE_REQUEST&&(M(o),o.phase=t.MATCH_REQUEST);e()}},q=()=>{const[e,s]=_();s.game.phase===t.MOVING&&($(s.game),e())},ee=e=>{const[s,o]=_();window.requestAnimationFrame(()=>{U(s.game,o,s.width,s.height,s.blockSize,e)})},se=e=>{const[s,o,r,h,m]=_(),l=e,{phase:d}=m.game;d===t.MOVING&&(l.code==="KeyA"?o():l.code==="KeyD"?r():l.code==="KeyS"||l.code==="Space"?s():l.code==="KeyW"&&h())},oe=L(n(()=>a(()=>import("./q-1730ff2d.js"),["build/q-1730ff2d.js","build/q-1f2f0220.js"]),"s_kyzWmZz43AM")),te=()=>{const e=A({width:0,height:0,game:{board:[...I],actor:{state:[...F],column:Math.floor(I[0].length/2),row:-2},phase:t.INACTIVE,savedPhase:t.INACTIVE,nextActor:Y(3),score:0,scores:Q},blockSize:0,level:Z.NORMAL,intervalId:null,gameOverPopup:!1}),s=E(),o=E(),r=n(()=>a(()=>Promise.resolve().then(()=>i),void 0),"s_xBCRT11r6XA",[e,o]),h=n(()=>a(()=>Promise.resolve().then(()=>i),void 0),"s_nEfr0b8SZhk",[r,e]),m=n(()=>a(()=>Promise.resolve().then(()=>i),void 0),"s_BeyZ0Sw0SmU",[r,e]),l=n(()=>a(()=>Promise.resolve().then(()=>i),void 0),"s_pQCiFx0OfCc",[r,e]),d=n(()=>a(()=>Promise.resolve().then(()=>i),void 0),"s_ceGxLRrlmgU",[e]),u=n(()=>a(()=>Promise.resolve().then(()=>i),void 0),"s_TkVYsNeLfzg",[r,e]);return T("resize",n(()=>a(()=>Promise.resolve().then(()=>i),void 0),"s_GNeO5nO3be8",[s,e])),w("keypress",n(()=>a(()=>Promise.resolve().then(()=>i),void 0),"s_G0CYh0nsyHk",[d,h,m,l,e])),C(n(()=>a(()=>Promise.resolve().then(()=>i),void 0),"s_LzrfCwaFyLk",[s,u,e])),V(n(()=>a(()=>Promise.resolve().then(()=>i),void 0),"s_IHgav91uwds",[e])),g("div",{ref:s},{class:"flex justify-center w-screen h-screen pt-5"},[e.gameOverPopup&&g("div",null,{class:"fixed top-1/2 left-1/2 -translate-y-1/2 -translate-x-1/2 z-50 w-72 opacity-60 text-center max-w-sm p-6 bg-white text-white border border-gray-200 rounded-lg shadow dark:bg-gray-800 dark:border-gray-700"},"GAME OVER",3,"eK_0"),g("div",null,null,g("svg",{ref:o},{class:"game-area",width:p(v=>v.width,[e]),height:p(v=>v.height,[e])},null,3,null),1,null),O(B,{get game(){return e.game},blockSize:15,get level(){return e.level},onStart$:n(()=>a(()=>Promise.resolve().then(()=>i),void 0),"s_xJrxY7wiGYs",[e]),onPause$:n(()=>a(()=>Promise.resolve().then(()=>i),void 0),"s_ROUfROoFvZc",[e]),onStop$:n(()=>a(()=>Promise.resolve().then(()=>i),void 0),"s_kYFzhOQnm80",[e]),onLeft$:h,onRight$:m,onSwap$:l,onDrop$:d,onLevel$:n(()=>a(()=>Promise.resolve().then(()=>i),void 0),"s_5C257LwJSZA",[u,e]),[c]:{game:p(v=>v.game,[e]),blockSize:c,level:p(v=>v.level,[e]),onStart$:c,onPause$:c,onStop$:c,onLeft$:c,onRight$:c,onSwap$:c,onDrop$:c,onLevel$:c}},3,"eK_1"),O(oe,null,3,"eK_2")],1,"eK_3")},re=()=>{const[e]=_();H(e.game),e.gameOverPopup=!1,e.game.phase=t.MOVING},ne=e=>{const[s,o]=_();o.level=e,o.intervalId!==null&&clearInterval(o.intervalId),o.intervalId=setInterval(s,R[o.level])},ae=()=>{const[e]=_();K(e.game)};function S(e,s){if(e!=null&&e.value){const{height:o}=e.value.getBoundingClientRect(),r=s.game.board.length,h=s.game.board[0].length,m=o*5/6,l=m/r,d=l*h;s.width=d,s.height=m,s.blockSize=l}}const ie=({cleanup:e})=>{const[s,o,r]=_();S(s,r),r.intervalId=setInterval(o,R[r.level]),e(()=>clearInterval(r.intervalId))},_e=()=>{const[e]=_();e.game.phase=t.INACTIVE,e.gameOverPopup=!0},le=({track:e})=>{const[s]=_();e(()=>s.gameOverPopup),s.gameOverPopup&&setTimeout(()=>{s.gameOverPopup=!1},5e3)},ce=()=>{const[e,s]=_();S(e,s)},i=Object.freeze(Object.defineProperty({__proto__:null,_hW:k,s_0eJNMN0ChX4:te,s_5C257LwJSZA:ne,s_BeyZ0Sw0SmU:q,s_G0CYh0nsyHk:se,s_GNeO5nO3be8:ce,s_IHgav91uwds:le,s_LzrfCwaFyLk:ie,s_ROUfROoFvZc:ae,s_TkVYsNeLfzg:j,s_ceGxLRrlmgU:J,s_kYFzhOQnm80:_e,s_nEfr0b8SZhk:W,s_pQCiFx0OfCc:X,s_xBCRT11r6XA:ee,s_xJrxY7wiGYs:re},Symbol.toStringTag,{value:"Module"}));export{k as _hW,te as s_0eJNMN0ChX4,ne as s_5C257LwJSZA,q as s_BeyZ0Sw0SmU,se as s_G0CYh0nsyHk,ce as s_GNeO5nO3be8,le as s_IHgav91uwds,ie as s_LzrfCwaFyLk,ae as s_ROUfROoFvZc,j as s_TkVYsNeLfzg,J as s_ceGxLRrlmgU,_e as s_kYFzhOQnm80,W as s_nEfr0b8SZhk,X as s_pQCiFx0OfCc,ee as s_xBCRT11r6XA,re as s_xJrxY7wiGYs};
